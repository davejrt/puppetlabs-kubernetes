apiVersion: kubeadm.k8s.io/v1beta1
caCertPath: /etc/kubernetes/pki/ca.crt
discovery:
  bootstrapToken:
    apiServerEndpoint: <%= @controller_address %>
    caCertHashes:
    - sha256:<%= @discovery_token_hash %>
    timeout: 5m0s
    token: <%= @token %>
    tlsBootstrapToken: <%= @tls_bootstrap_token %>
    unsafeSkipCAVerification: false
kind: JoinConfiguration
nodeRegistration:
  name: <%= @node_name %>
  <%- if @container_runtime == "cri_containerd" -%>
  criSocket: /run/containerd/containerd.sock
  <%- end -%>
  <%- if @kubelet_merged_extra_arguments -%>
  kubeletExtraArgs:
    <%- @kubelet_merged_extra_arguments.each do |arg| -%>
    <%= arg %>
    <%- end -%>
  <%- end -%>